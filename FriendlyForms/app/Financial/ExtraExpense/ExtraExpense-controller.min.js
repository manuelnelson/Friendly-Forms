var ExtraExpenseCtrl=function(a,b,c,d,e,f,g){a.path=c.path(),a.showErrors=!1,a.showMessage=!1,a.isLoaded=!1,d.children.get({UserId:b.userId},function(c){a.children=c.Children,a.childNdx=_.indexOf(_.pluck(a.children,"Id"),parseInt(b.childId)),a.childName=a.children[a.childNdx].Name}),a.getChildExtraExpense=function(b){a.extraExpense=d.extraExpenses.get({ChildId:b},function(){if(typeof a.extraExpense.Id=="undefined"||a.extraExpense.Id==0)a.extraExpense=$.jStorage.get(a.path)})},a.extraExpenseForm=d.extraExpenseForms.get({UserId:b.userId},function(){if(typeof a.extraExpenseForm.Id=="undefined"||a.extraExpenseForm.Id==0)a.showErrors=!0;a.isLoaded=!0}),a.submit=function(c){if(!a.extraExpenseForm||a.extraExpenseForm.HasExtraExpenses!="1"&&a.extraExpenseForm.HasExtraExpenses!="2"){e.setSubMenuIconClass(a.path,"icon-pencil icon-red");return}a.showErrors=!1,a.extraExpenseForm.UserId=b.userId,typeof a.extraExpenseForm.Id=="undefined"||a.extraExpenseForm.Id==0?d.extraExpenseForms.save(null,a.extraExpenseForm,function(b){a.extraExpenseForm.Id=b.Id,e.setSubMenuIconClass(a.path,"icon-ok icon-green")}):d.extraExpenseForms.update(null,a.extraExpenseForm,function(){e.setSubMenuIconClass(a.path,"icon-ok icon-green")})},a.submitExtraExpense=function(c){if(a.extraExpenseChildForm.$invalid){var e=f.getFormInput("#extraExpenseChildForm");$.jStorage.set(a.path,e),c&&c();return}$.jStorage.deleteKey(a.path),a.extraExpense||(a.extraExpense={}),a.extraExpense.UserId=b.userId,a.extraExpense.ChildId=a.children[a.childNdx].Id,typeof a.extraExpense.Id=="undefined"||a.extraExpense.Id==0?d.extraExpenses.save(null,a.extraExpense,function(){c()}):d.extraExpenses.update({Id:a.extraExpense.Id},a.extraExpense,function(){c()})},a.previousChild=function(){a.submitExtraExpense(function(){if(!a.extraExpenseForm||!a.extraExpenseForm.HasExtraExpenses||a.extraExpenseForm.HasExtraExpenses==2){e.previousMenu();return}a.childNdx=_.indexOf(_.pluck(a.children,"Id"),parseInt(b.childId));if(a.childNdx===0){e.previousMenu();return}a.childNdx=a.childNdx-1;var d=a.children[a.childNdx].Id;c.path("/Financial/ExtraExpense/user/"+b.userId+"/child/"+d)})},a.nextChild=function(){a.submitExtraExpense(function(){if(!a.extraExpenseForm.HasExtraExpenses||a.extraExpenseForm.HasExtraExpenses==2){e.nextMenu();return}a.childNdx=_.indexOf(_.pluck(a.children,"Id"),parseInt(b.childId));if(a.childNdx===a.children.length-1){e.nextMenu();return}a.childNdx=a.childNdx+1;var d=a.children[a.childNdx].Id;e.setSubMenuIconClass(a.path,"icon-ok icon-green"),c.path("/Financial/ExtraExpense/user/"+b.userId+"/child/"+d)})},a.getChildExtraExpense(b.childId),f.refreshPage(function(){g.currentScope=a})};ExtraExpenseCtrl.$inject=["$scope","$routeParams","$location","extraExpenseService","menuService","genericService","$rootScope"]