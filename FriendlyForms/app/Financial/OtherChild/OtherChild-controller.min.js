var OtherChildCtrl=["$scope","$routeParams","$location","otherChildService","menuService","genericService","userService","$rootScope","$q",function(a,b,c,d,e,f,g,h,i){a.continuePressed=!1,a.path=c.path(),a.isLoaded=!1,a.showErrors=!1,d.otherChildren.get({UserId:b.userId,IsOtherParent:b.isOtherParent},function(b){a.isLoaded=!0,typeof b.Id=="undefined"||b.Id==0?(a.otherChildren=$.jStorage.get(a.path),a.otherChildren&&(a.showErrors=!0)):a.otherChildren=b,typeof a.otherChildren!="undefined"&&a.otherChildren!==null&&a.otherChildren.Id>0?d.otherChild.get({OtherChildrenId:b.Id},function(b){b.OtherChildren.length==0?a.children=[]:a.children=b.OtherChildren}):a.children=[]}),a.showMessage=!1,a.checkToShowMessage=function(){(a.otherChildren.LegallyResponsible!=1||a.otherChildren.AtHome!=1||a.otherChildren.Support!=1||a.otherChildren.Preexisting!=2||a.otherChildren.InCourt!=2)&&a.otherChildrenForm.LegallyResponsible.$dirty&&a.otherChildrenForm.AtHome.$dirty&&a.otherChildrenForm.Support.$dirty&&a.otherChildrenForm.Preexisting.$dirty&&a.otherChildrenForm.InCourt.$dirty&&(a.showMessage=!0)},a.submit=function(c){var h=i.defer();if(a.otherChildrenForm.$invalid){e.setSubMenuIconClass(a.path,"icon-exclamation icon-red");var j=f.getFormInput("#otherChildrenForm");return $.jStorage.set(a.path,j),c||e.nextMenu(),h.promise}return $.jStorage.deleteKey(a.path),a.otherChildren.UserId=g.getFormUserId(),a.otherChildren.IsOtherParent=b.isOtherParent,typeof a.otherChildren.Id=="undefined"||a.otherChildren.Id==0?d.otherChildren.save(null,a.otherChildren,function(b){a.otherChildren=b,h.resolve(),e.setSubMenuIconClass(a.path,"icon-ok icon-green"),c||e.nextMenu()}):d.otherChildren.update(null,a.otherChildren,function(){h.resolve(),e.setSubMenuIconClass(a.path,"icon-ok icon-green"),c||e.nextMenu()}),h.promise},a.addOtherChild=function(){a.submit(!0).then(function(){a.otherChild.OtherChildrenId=a.otherChildren.Id,a.otherChild.UserId=g.getFormUserId(),d.otherChild.save(null,a.otherChild,function(b){e.setSubMenuIconClass(a.path,"icon-ok icon-green"),a.children.push(b.OtherChild),a.otherChildForm.$setPristine(),a.otherChild=""})})},a.deleteOtherChild=function(b){d.otherChild.delete({Id:b.Id},function(){a.children=_.reject(a.children,function(a){return a.Id==b.Id})})},a.editing=!1,a.editOtherChild=function(b){a.editing=!0,a.editChildId=b.Id},a.doneEdit=function(b){a.editing=!1,a.editChildId=0,d.otherChild.update({},b,function(){})},f.refreshPage(function(){h.currentScope=a})}]