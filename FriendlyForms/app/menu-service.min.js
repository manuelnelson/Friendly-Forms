FormsApp.factory("menuService",function(a,b,c){var d={menuItems:[],isInitialized:!1,setItems:function(a){d.menuItems=a},menu:c("/api/menus/:userId",{userId:"@userId"},{getList:{method:"GET",isArray:!0,params:{format:"json"}}}),getMenu:function(b){var c=d.userId;typeof c=="undefined"&&(c=0),d.menu.getList({Route:a.path(),UserId:c},function(a){d.setItems(a),d.isInitialized=!0,b&&b()})},getMenuGroupByPath:function(a){for(var b=0;b<d.menuItems.length;b++){var c=d.menuItems[b];if(c.path===a)return{menuItem:c,subMenuItem:null};var e=_.find(c.subMenuItems,function(b){return b.path===a});if(e)return{menuItem:c,subMenuItem:e}}},setSubMenuIconClass:function(a,b){var c=d.getMenuGroupByPath(a);c.subMenuItem&&(c.subMenuItem.iconClass=b)},isActive:function(a){if(d.isInitialized){var b=d.getMenuGroupByPath(a);if(b.subMenuItem)return b.subMenuItem.itemClass==="active"}return!1},setActive:function(a){d.isInitialized?d.setActiveCallback(a)():d.getMenu(d.setActiveCallback(a))},setActiveCallback:function(b){return function(){d.checkForm(),d.clearActive();var c=_.find(d.menuItems,function(a){return a.path===b});c&&(c.itemClass="active");var e=d.getMenuGroupByPath(b);e.menuItem.showSubMenu=!0,e.menuItem.itemClass="submenu active",e.subMenuItem.itemClass="active",e.subMenuItem.iconClass="icon-blue icon-pencil",a.path(e.subMenuItem.path)}},clearActive:function(){angular.forEach(d.menuItems,function(a){for(var b=0;b<a.subMenuItems.length;b++)a.subMenuItems[b].itemClass="";a.itemClass=""})},checkForm:function(){var a;for(var c=0;c<d.menuItems.length;c++){var e=d.menuItems[c];a=_.find(e.subMenuItems,function(a){return a.iconClass==="icon-blue icon-pencil"});if(a){var f=b.$root.currentScope;f.submit(!0);break}}},userId:0};return d})