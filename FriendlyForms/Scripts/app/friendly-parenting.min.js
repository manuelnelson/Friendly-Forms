function saveExtraDecisions(a){var b="extraDecisions";$.each($(".extra-decision-item"),function(c,d){var e=$(d).children("#extra-decision-Id").val(),f={Id:typeof a=="undefined"?e:0,ChildId:typeof a=="undefined"?$(d).children("#extra-decision-childId").val():a,DecisionMaker:$(d).find("input[name=ExtraDecisions"+e+"]:checked").val(),Description:$(d).children("#extra-decision-description").text().trim(),UserId:$("#user-id").val()};if(typeof a!="undefined"){$.ajax({url:"/api/"+b+"/"+a+"?format=json",type:"GET",success:function(a){$.each(a,function(a,b){b.Description===f.Description&&(f.Id=b.Id)}),$.ajax({url:"/api/"+b+"/?format=json",type:"POST",data:f,success:function(){},error:Friendly.GenericErrorMessage})},error:Friendly.GenericErrorMessage});return}$.ajax({url:"/api/"+b+"/?format=json",type:"POST",data:f,success:function(){},error:Friendly.GenericErrorMessage})})}function getChildDecisions(a){$.ajax({url:"/api/Decisions?ChildId="+a.Id+"&format=json",type:"GET",success:function(b){$("#childName").text(a.Name),$("#childId").val(a.Id),$('#DecisionsViewModel_Education[value="'+b.Decisions.Education+'"]').attr("checked","checked"),$('#DecisionsViewModel_HealthCare[value="'+b.Decisions.HealthCare+'"]').attr("checked","checked"),$('#DecisionsViewModel_Religion[value="'+b.Decisions.Religion+'"]').attr("checked","checked"),$('#DecisionsViewModel_ExtraCurricular[value="'+b.Decisions.ExtraCurricular+'"]').attr("checked","checked"),$("#DecisionsViewModel_BothResolve").val(b.Decisions.BothResolve),$(".extra-decision-item").remove(),$.each(b.ExtraDecisions,function(a,b){var c=$("#friendly-extraDecisions-template").tmpl(b);$("#radio-decisions").append(c)}),checkIfBothIsChecked(),b.Decisions.Education!==0&&$("#decisions").valid(),$("#decisionsWrapper").show()},error:Friendly.GenericErrorMessage})}function checkIfBothIsChecked(){var a=!1;$.each($("#decisions input[type=radio]"),function(b,c){var d=$(c).attr("id");$("#"+d+":checked").val()==="3"&&(a=!0)}),a?$(".decision-details").show():($("#DecisionsViewModel_BothResolve").val(""),$(".decision-details").hide())}function loadChildren(a){Friendly.children=[],$(".copy-button ul").empty(),$(".copy-button ul").append('<li><a title="all" data-id="0" href="#">All</a></li>'),$.each($(".child-table tbody tr"),function(a,b){var c={Name:$(b).find(".child-name").text(),DateOfBirth:$(b).find(".child-dob").text(),Id:$(b).find(".child-id").text().trim()};Friendly.children.push(c),$(".copy-button ul").append('<li><a title="all" data-id="'+c.Id+'" href="#">'+c.Name+"</a></li>")}),Friendly.children.length<=1&&$(".copy-wrapper").hide(),Friendly.childNdx=0;var b=Friendly.children[Friendly.childNdx];switch(a){case"decision":getChildDecisions(b);break;case"holiday":getChildHoliday(b)}}function getChildHoliday(a){$.ajax({url:"/api/Holiday/"+a.Id+"?format=json",type:"GET",success:function(b){setChildHolidayForm(b,a),b.Holidays.SpringBreakFather!==0&&$("#holiday").valid(),$("#holidayWrapper").show(),$(".holiday-item").addClass("active")},error:Friendly.GenericErrorMessage})}function setChildHolidayForm(a,b){Friendly.ClearForm("holiday"),$("#holidayChildName").text(b.Name),$("#holidayChildId").val(b.Id),a.Holidays.FridayHoliday?($("#HolidayViewModel_FridayHoliday").attr("checked","checked"),$("#HolidayViewModel_FridayHoliday").val("true")):$("#HolidayViewModel_FridayHoliday").val("false"),a.Holidays.MondayHoliday?($("#HolidayViewModel_MondayHoliday").attr("checked","checked"),$("#HolidayViewModel_MondayHoliday").val("true")):$("#HolidayViewModel_MondayHoliday").val("false"),$('#HolidayViewModel_Thanksgiving[value="'+a.Holidays.Thanksgiving+'"]').attr("checked","checked"),$("#HolidayViewModel_ThanksgivingOther").val(a.Holidays.ThanksgivingOther),$('#HolidayViewModel_Christmas[value="'+a.Holidays.Christmas+'"]').attr("checked","checked"),$("#HolidayViewModel_ChristmasTime").val(a.Holidays.ChristmasTime),$("#HolidayViewModel_SpringBreakTime").val(a.Holidays.SpringBreakTime),$("#HolidayViewModel_FallBreakTime").val(a.Holidays.FallBreakTime),$("#HolidayViewModel_ThanksgivingTime").val(a.Holidays.ThanksgivingTime),$("#HolidayViewModel_ChristmasOther").val(a.Holidays.ChristmasOther),$('#HolidayViewModel_SpringBreak[value="'+a.Holidays.SpringBreak+'"]').attr("checked","checked"),$("#HolidayViewModel_SpringOther").val(a.Holidays.SpringOther),$("#HolidayViewModel_SummerBeginDays").val(a.Holidays.SummerBeginDays),$("#HolidayViewModel_SummerBeginTime").val(a.Holidays.SummerBeginTime),$("#HolidayViewModel_SummerEndDays").val(a.Holidays.SummerEndDays),$("#HolidayViewModel_SummerEndTime").val(a.Holidays.SummerEndTime),$("#HolidayViewModel_SummerDetails").val(a.Holidays.SummerDetails),$('#HolidayViewModel_FallBreak[value="'+a.Holidays.FallBreak+'"]').attr("checked","checked"),$("#HolidayViewModel_FallOther").val(a.Holidays.FallOther),$('#HolidayViewModel_SpringBreakFather[value="'+a.Holidays.SpringBreakFather+'"]').attr("checked","checked"),$('#HolidayViewModel_SpringBreakMother[value="'+a.Holidays.SpringBreakMother+'"]').attr("checked","checked"),$('#HolidayViewModel_FallBreakFather[value="'+a.Holidays.FallBreakFather+'"]').attr("checked","checked"),$('#HolidayViewModel_FallBreakMother[value="'+a.Holidays.FallBreakMother+'"]').attr("checked","checked"),$('#HolidayViewModel_ThanksgivingFather[value="'+a.Holidays.ThanksgivingFather+'"]').attr("checked","checked"),$('#HolidayViewModel_ThanksgivingMother[value="'+a.Holidays.ThanksgivingMother+'"]').attr("checked","checked"),$('#HolidayViewModel_ChristmasFather[value="'+a.Holidays.ChristmasFather+'"]').attr("checked","checked"),$('#HolidayViewModel_ChristmasMother[value="'+a.Holidays.ChristmasMother+'"]').attr("checked","checked"),$('#HolidayViewModel_MlkFather[value="'+a.Holidays.MlkFather+'"]').attr("checked","checked"),$('#HolidayViewModel_MlkMother[value="'+a.Holidays.MlkMother+'"]').attr("checked","checked"),$('#HolidayViewModel_PresidentsFather[value="'+a.Holidays.PresidentsFather+'"]').attr("checked","checked"),$('#HolidayViewModel_PresidentsMother[value="'+a.Holidays.PresidentsMother+'"]').attr("checked","checked"),$('#HolidayViewModel_MothersFather[value="'+a.Holidays.MothersFather+'"]').attr("checked","checked"),$('#HolidayViewModel_MothersMother[value="'+a.Holidays.MothersMother+'"]').attr("checked","checked"),$('#HolidayViewModel_MemorialFather[value="'+a.Holidays.MemorialFather+'"]').attr("checked","checked"),$('#HolidayViewModel_MemorialMother[value="'+a.Holidays.MemorialMother+'"]').attr("checked","checked"),$('#HolidayViewModel_FathersFather[value="'+a.Holidays.FathersFather+'"]').attr("checked","checked"),$('#HolidayViewModel_FathersMother[value="'+a.Holidays.FathersMother+'"]').attr("checked","checked"),$('#HolidayViewModel_IndependenceFather[value="'+a.Holidays.IndependenceFather+'"]').attr("checked","checked"),$('#HolidayViewModel_IndependenceMother[value="'+a.Holidays.IndependenceMother+'"]').attr("checked","checked"),$('#HolidayViewModel_LaborFather[value="'+a.Holidays.LaborFather+'"]').attr("checked","checked"),$('#HolidayViewModel_LaborMother[value="'+a.Holidays.LaborMother+'"]').attr("checked","checked"),$('#HolidayViewModel_HalloweenFather[value="'+a.Holidays.HalloweenFather+'"]').attr("checked","checked"),$('#HolidayViewModel_HalloweenMother[value="'+a.Holidays.HalloweenMother+'"]').attr("checked","checked"),$('#HolidayViewModel_ChildrensFather[value="'+a.Holidays.ChildrensFather+'"]').attr("checked","checked"),$('#HolidayViewModel_ChildrensMother[value="'+a.Holidays.ChildrensMother+'"]').attr("checked","checked"),$('#HolidayViewModel_MothersBdayFather[value="'+a.Holidays.MothersBdayFather+'"]').attr("checked","checked"),$('#HolidayViewModel_MothersBdayMother[value="'+a.Holidays.MothersBdayMother+'"]').attr("checked","checked"),$('#HolidayViewModel_FathersBdayFather[value="'+a.Holidays.FathersBdayFather+'"]').attr("checked","checked"),$('#HolidayViewModel_FathersBdayMother[value="'+a.Holidays.FathersBdayMother+'"]').attr("checked","checked"),$('#HolidayViewModel_ReligiousFather[value="'+a.Holidays.ReligiousFather+'"]').attr("checked","checked"),$('#HolidayViewModel_ReligiousMother[value="'+a.Holidays.ReligiousMother+'"]').attr("checked","checked"),$(".extra-holiday-item").remove(),$.each(a.ExtraHolidays,function(a,b){var c=$("#friendly-extraHolidays-template").tmpl(b);$("#holiday").append(c)})}function saveExtraHolidays(a){var b="extraHoliday";$.each($(".extra-holiday-item"),function(c,d){var e=$(d).children("#extra-holiday-Id").val(),f={Id:typeof a=="undefined"?e:0,ChildId:typeof a=="undefined"?$(d).children("#extra-holiday-childId").val():a,HolidayFather:$(d).find("input[name=HolidayFather"+e+"]:checked").val(),HolidayMother:$(d).find("input[name=HolidayMother"+e+"]:checked").val(),HolidayName:$(d).children(".extra-holiday-name").text(),UserId:$("#user-id").val()};if(typeof a!="undefined"){$.ajax({url:"/api/"+b+"/"+a+"?format=json",type:"GET",success:function(a){$.each(a.ExtraHolidays,function(a,b){b.HolidayName===f.HolidayName&&(f.Id=b.Id)}),$.ajax({url:"/api/"+b+"?format=json",type:"POST",data:f,success:function(){},error:Friendly.GenericErrorMessage})},error:Friendly.GenericErrorMessage});return}$.ajax({url:"/api/"+b+"?format=json",type:"POST",data:f,success:function(){},error:Friendly.GenericErrorMessage})})}function AddHoliday(a){var b="holiday";if($("#"+b).valid()){saveExtraHolidays();var c=Friendly.GetFormInput(b);return c.ChildId=$("#holidayChildId").val(),a!=null&&$(a).hasClass("next")?Friendly.childNdx++:a!=null&&Friendly.childNdx--,a!=null&&$(a).hasClass("next")&&Friendly.childNdx===Friendly.children.length?(Friendly.StartLoading(),$.ajax({url:"/api/"+b+"?format=json",type:"POST",data:c,success:function(){var a=["privacy","information","decisions","responsibility","communication","schedule","holiday"];Friendly.ValidateForms(a,".child-part10"),Friendly.EndLoading()},error:Friendly.GenericErrorMessage}),!1):a!=null&&$(a).hasClass("previous")&&Friendly.childNdx<0?(Friendly.SubmitForm("holiday","schedule",c),!1):(Friendly.StartLoading(),$.ajax({url:"/api/"+b+"?format=json",type:"POST",data:c,success:function(){$("#"+b)[0].reset(),$("html, body").animate({scrollTop:0},"fast");var a=Friendly.children[Friendly.childNdx];getChildHoliday(a),Friendly.EndLoading()},error:Friendly.GenericErrorMessage}),!0)}}$(document).ready(function(){function a(a){saveExtraDecisions(a);var b=Friendly.GetFormInput("decisions");b.ChildId=typeof a=="undefined"?$("#childId").val():a,$.ajax({url:"/api/Decisions?format=json",type:"POST",data:b,success:function(){},error:Friendly.GenericErrorMessage})}function b(a,b){switch(b){case"1":$("#"+a+'[value="2"]').attr("checked","checked");break;case"2":$("#"+a+'[value="1"]').attr("checked","checked");break;case"3":$("#"+a+'[value="4"]').attr("checked","checked");break;case"4":$("#"+a+'[value="3"]').attr("checked","checked")}}function c(a){saveExtraHolidays(a);var b="holiday",c=Friendly.GetFormInput(b);c.ChildId=a,c.FridayHoliday=$("#HolidayViewModel_FridayHoliday").is(":checked"),c.MondayHoliday=$("#HolidayViewModel_MondayHoliday").is(":checked"),$.ajax({url:"/api/"+b+"?format=json",type:"POST",data:c,success:function(){},error:Friendly.GenericErrorMessage})}$("input[name=NeedPrivacy]").change(function(){$("#NeedPrivacy:checked").val()==="1"?$("#detailsWrapper").show():$("#detailsWrapper").hide()}),$(".child-part4").click(function(){$(this).hasClass("next")&&Friendly.SubmitForm("privacy","information")}),$(".child-part5").click(function(){Friendly.StartLoading();var a=Friendly.GetFormInput("information");loadChildren("decision");var b="information",c="decisions",d="#"+b;if($(d).valid())$.ajax({url:"/api/"+b+"/?format=json",type:"POST",data:a,success:function(){return Friendly.NextForm(c,Friendly.properties.iconSuccess),Friendly.EndLoading(),!1},error:Friendly.GenericErrorMessage});else return Friendly.EndLoading(),!1;return!1}),$("#addDecisions").click(function(){Friendly.StartLoading();var a="extraDecisions",b=Friendly.GetFormInput(a);b.ChildId=$("#childId").val().trim();if($("#"+a).valid())$.ajax({url:"/api/"+a+"?format=json",type:"POST",data:b,success:function(a){var b=$("#friendly-extraDecisions-template").tmpl(a.ExtraDecision);return $("#radio-decisions").append(b),$("input[id=ExtraDecisionsViewModel_DecisionMaker]").removeAttr("checked"),$("#ExtraDecisionsViewModel_Description").val(""),Friendly.EndLoading(),!1},error:Friendly.GenericErrorMessage});else return Friendly.EndLoading(),!1;return!1}),$("#decisions input[type=radio]").live("change",checkIfBothIsChecked),$(".dropdown-toggle").dropdown(),$("#copy-decisions").on("click","li a",function(){if(!$("#decisions").valid())return!1;var b=$(this).attr("data-id");if(b==="0")for(var c=0;c<Friendly.children.length;c++){var d=Friendly.children[c];a(d.Id)}else a(b)}),$(".child-part6").click(function(){Friendly.AddDecision(this)}),$("input[name=TransportationCosts]").change(function(){var a=$("#TransportationCosts:checked").val();$(".responsibility-percentage").hide(),$(".responsibility-cost").hide(),$(".responsibility-percentage input").val("0"),$(".responsibility-cost input").val("");switch(a){case"3":$(".responsibility-percentage").show(),$(".responsibility-percentage input").val("");break;case"4":$(".responsibility-cost").show()}}),$(".responsibility-percentage input").focusout(function(){var a=$(this).val();$(this).attr("id")==="FatherPercentage"?$("#MotherPercentage").val(parseInt(100-a)):$("#FatherPercentage").val(parseInt(100-a))}),$(".child-part7").click(function(){var a={BeginningVisitation:$("#BeginningVisitation:checked").val(),EndVisitation:$("#EndVisitation:checked").val(),TransportationCosts:$("#TransportationCosts:checked").val(),FatherPercentage:0,MotherPercentage:0,UserId:$("#user-id").val(),OtherDetails:""};a.TransportationCosts==="3"&&(a.FatherPercentage=$("#FatherPercentage").val(),a.MotherPercentage=$("#MotherPercentage").val()),a.TransportationCosts==="4"&&(a.OtherDetails=$("#OtherDetails").val()),Friendly.SubmitForm("responsibility","communication",a)}),$("#Other").change(function(){$(this).is(":checked")?$(".communicate-other").show():$(".communicate-other").hide()}),$("input[name=Limitations]").change(function(){var a=$("#Limitations:checked").val();a=="1"?$(".communicate-method").show():$(".communicate-method").hide()}),$(".child-part8").click(function(){Friendly.SubmitForm("communication","schedule")}),$("input[name=DetermineBeginDate]").change(function(){var a=$("#DetermineBeginDate:checked").val();a==="1"?$(".schedule-date").hide():$(".schedule-date").show()}),$("input[name=Weekdays]").change(function(){var a=$("#Weekdays:checked").val();a==="1"?$(".schedule-weekday").show():$(".schedule-weekday").hide()}),$("input[name=FatherWeekend]").change(function(){var a=$("#FatherWeekend:checked").val();$(".schedule-weekend-other").hide();switch(a){case"1":$('#MotherWeekend[value="1"]').attr("checked","checked");break;case"2":$('#MotherWeekend[value="4"]').attr("checked","checked");break;case"3":$('#MotherWeekend[value="4"]').attr("checked","checked");break;case"4":$('#MotherWeekend[value="3"]').attr("checked","checked");break;case"5":$('#MotherWeekend[value="5"]').attr("checked","checked"),$(".schedule-weekend-other").show()}}),$("input[name=MotherWeekend]").change(function(){var a=$("#MotherWeekend:checked").val();$(".schedule-weekend-other").hide();switch(a){case"1":$('#FatherWeekend[value="1"]').attr("checked","checked");break;case"2":$('#FatherWeekend[value="4"]').attr("checked","checked");break;case"3":$('#FatherWeekend[value="4"]').attr("checked","checked");break;case"4":$('#FatherWeekend[value="3"]').attr("checked","checked");break;case"5":$('#FatherWeekend[value="5"]').attr("checked","checked"),$(".schedule-weekend-other").show()}}),$(".child-part9").click(function(){var a=Friendly.GetFormInput("schedule"),b="schedule",c="holiday",d="#"+b;if($(d).valid())$.ajax({url:"/api/"+b+"?format=json",type:"POST",data:a,success:function(){return loadChildren("holiday"),Friendly.NextForm(c,Friendly.properties.iconSuccess),Friendly.EndLoading(),!1},error:Friendly.GenericErrorMessage});else return Friendly.EndLoading(),!1;return!1}),$("#addHolidays").click(function(){Friendly.StartLoading();var a="extraHoliday",b={ChildId:$("#holidayChildId").val(),HolidayFather:$("#ExtraHolidayViewModel_HolidayFather:checked").val(),HolidayMother:$("#ExtraHolidayViewModel_HolidayMother:checked").val(),HolidayName:$("#ExtraHolidayViewModel_HolidayName").val(),UserId:$("#user-id").val()};if($("#"+a).valid())$.ajax({url:"/api/"+a+"?format=json",type:"POST",data:b,success:function(a){var b=$("#friendly-extraHolidays-template").tmpl(a.ExtraHoliday);return $("#holiday").append(b),$("input[id=ExtraHolidayViewModel_HolidayFather]").removeAttr("checked"),$("input[id=ExtraHolidayViewModel_HolidayMother]").removeAttr("checked"),$("#ExtraHolidayViewModel_HolidayName").val(""),Friendly.EndLoading(),!1},error:Friendly.GenericErrorMessage});else return Friendly.EndLoading(),!1;return!1}),$(".father-all input[type=radio]").change(function(){var a=$(this).attr("name"),c=$('input[name="'+a+'"]:checked').val();$.each($(".holiday-parent input[value="+c+"]"),function(a,d){var e=$(d).attr("name");if(typeof e=="undefined")return;e.lastIndexOf("Father")>=0&&e.lastIndexOf("Father")>e.lastIndexOf("Mother")?$(this).attr("checked","checked"):(e=e.replace(".","_"),b(e,c))})}),$(".mother-all input[type=radio]").change(function(){var a=$(this).attr("name"),c=$('input[name="'+a+'"]:checked').val();$.each($(".holiday-parent input[value="+c+"]"),function(a,d){var e=$(d).attr("name");if(typeof e=="undefined")return;e.lastIndexOf("Mother")>=0&&e.lastIndexOf("Mother")>e.lastIndexOf("Father")?$(this).attr("checked","checked"):(e=e.replace(".","_"),b(e,c))})}),$(".holiday-parent input[type=radio]").live("change",function(){var a=$(this).attr("name"),c=$('input[name="'+a+'"]:checked').val(),d="",e="";return a.lastIndexOf("Father")>=0&&a.lastIndexOf("Father")>a.lastIndexOf("Mother")?(a.length>a.lastIndexOf("Father")+6&&(e=a.substring(a.lastIndexOf("Father")+6,a.length)),d=a.substring(0,a.lastIndexOf("Father"))+"Mother"+e,d=d.replace(".","_")):a.lastIndexOf("Mother")>=0&&a.lastIndexOf("Mother")>a.lastIndexOf("Father")&&(d=a.substring(0,a.lastIndexOf("Mother"))+"Father",d=d.replace(".","_")),b(d,c),!1}),$(".child-part10").click(function(){AddHoliday(this)}),$('input[name="HolidayViewModel.Thanksgiving"]').change(function(){var a=$("#HolidayViewModel_Thanksgiving:checked").val();a==="3"?$(".thanksgiving-other").show():$(".thanksgiving-other").hide()}),$('input[name="HolidayViewModel.SpringBreak"]').change(function(){var a=$("#HolidayViewModel_SpringBreak:checked").val();a==="2"?$(".spring-other").show():$(".spring-other").hide()}),$('input[name="HolidayViewModel.FallBreak"]').change(function(){var a=$("#HolidayViewModel_FallBreak:checked").val();a==="2"?$(".fall-other").show():$(".fall-other").hide()}),$('input[name="HolidayViewModel.Christmas"]').change(function(){var a=$("#HolidayViewModel_Christmas:checked").val();$(".christmas-items").hide(),$(".christmas-other").hide();switch(a){case"2":$(".christmas-items").show();break;case"3":$(".christmas-items").show();break;case"4":$(".christmas-items").show();break;case"5":$(".christmas-other").show()}}),$("#copy-holidays").on("click","li a",function(){if(!$("#holiday").valid())return;var a=$(this).attr("data-id");if(a==="0")for(var b=0;b<Friendly.children.length;b++){var d=Friendly.children[b];c(d.Id)}else c(a)})})