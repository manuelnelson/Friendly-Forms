$(function(a){function b(b,c){Parenting.SaveExtraDecisions(b);var d=Friendly.GetFormInput("decisions");d.ChildId=typeof b=="undefined"?a("#childId").val():b,a.ajax({url:"/api/Decisions?format=json",type:"POST",data:d,success:function(){c&&Friendly.ShowMessage("Success!","The decisions section have successfully been copied. You can continue to make changes by cycling through the children using the previous and continue buttons.",Friendly.properties.messageType.Success,"#decisionsWrapper .copy-wrapper")},error:Friendly.GenericErrorMessage})}function c(b,c){switch(c){case"1":a("#"+b+'[value="2"]').attr("checked","checked");break;case"2":a("#"+b+'[value="1"]').attr("checked","checked");break;case"3":a("#"+b+'[value="4"]').attr("checked","checked");break;case"4":a("#"+b+'[value="3"]').attr("checked","checked")}}function d(b,c){Parenting.SaveExtraHolidays(b);var d="holiday",e=Friendly.GetFormInput(d);e.ChildId=typeof b=="undefined"?a("#holidayChildId").val():b,e.FridayHoliday=a("#HolidayViewModel_FridayHoliday").is(":checked"),e.MondayHoliday=a("#HolidayViewModel_MondayHoliday").is(":checked"),a.ajax({url:"/api/"+d+"?format=json",type:"POST",data:e,success:function(){c&&Friendly.ShowMessage("Success!","The holiday section have successfully been copied. You can continue to make changes by cycling through the children using the previous and continue buttons.",Friendly.properties.messageType.Success,"#holidayWrapper .copy-wrapper")},error:Friendly.GenericErrorMessage})}a("input[name=NeedSupervision]").change(function(){a("#NeedSupervision:checked").val()==="1"?a(".supervision-details").show():a(".supervision-details").hide()}),a(".child-part4").click(function(){a(this).hasClass("next")&&Friendly.SubmitForm("privacy","information")}),a(".child-part5").click(function(){Friendly.StartLoading();var b=Friendly.GetFormInput("information");Parenting.LoadChildren("decision");var c="information",d="decisions",e="#"+c;if(a(e).valid())a.ajax({url:"/api/"+c+"?format=json",type:"POST",data:b,success:function(){return Friendly.NextForm(d,Friendly.properties.iconSuccess),Friendly.EndLoading(),!1},error:Friendly.GenericErrorMessage});else return Friendly.EndLoading(),!1;return!1}),a("#addDecisions").click(function(){Friendly.StartLoading();var b="extraDecisions",c=Friendly.GetFormInput(b);c.ChildId=a("#childId").val().trim();if(a("#"+b).valid())a.ajax({url:"/api/"+b+"?format=json",type:"POST",data:c,success:function(b){var c=a("#friendly-extraDecisions-template").tmpl(b.ExtraDecision);return a("#radio-decisions").append(c),a("input[id=ExtraDecisionsViewModel_DecisionMaker]").removeAttr("checked"),a("#ExtraDecisionsViewModel_Description").val(""),Friendly.EndLoading(),!1},error:Friendly.GenericErrorMessage});else return Friendly.EndLoading(),!1;return!1}),a("#decisions input[type=radio]").live("change",Parenting.CheckIfBothIsChecked),a(".dropdown-toggle").dropdown(),a("#copy-decisions").on("click","li a",function(){if(!a("#decisions").valid())return!1;Friendly.StartLoading();var c=a(this).attr("data-id");if(c==="0")for(var d=0;d<Friendly.children.length;d++){var e=Friendly.children[d];d==Friendly.children.length-1?b(e.Id,!0):b(e.Id,!1)}else{var f=a("#childId").val().trim();b(f,!1),b(c,!0)}Friendly.EndLoading()}),a(".child-part6").click(function(){Parenting.AddDecision(this)}),a("input[name=TransportationCosts]").change(function(){var b=a("#TransportationCosts:checked").val();a(".responsibility-percentage").hide(),a(".responsibility-cost").hide(),a(".responsibility-percentage input").val("0"),a(".responsibility-cost input").val("");switch(b){case"3":a(".responsibility-percentage").show(),a(".responsibility-percentage input").val("");break;case"4":a(".responsibility-cost").show()}}),a(".responsibility-percentage input").focusout(function(){var b=a(this).val();a(this).attr("id")==="FatherPercentage"?a("#MotherPercentage").val(parseInt(100-b)):a("#FatherPercentage").val(parseInt(100-b))}),a(".child-part7").click(function(){var b={BeginningVisitation:a("#BeginningVisitation:checked").val(),EndVisitation:a("#EndVisitation:checked").val(),TransportationCosts:a("#TransportationCosts:checked").val(),FatherPercentage:0,MotherPercentage:0,UserId:a("#user-id").val(),OtherDetails:""};b.TransportationCosts==="3"&&(b.FatherPercentage=a("#FatherPercentage").val(),b.MotherPercentage=a("#MotherPercentage").val()),b.TransportationCosts==="4"&&(b.OtherDetails=a("#OtherDetails").val()),Friendly.SubmitForm("responsibility","communication",b)}),a("#Other").change(function(){a(this).is(":checked")?a(".communicate-other").show():a(".communicate-other").hide()}),a("input[name=Limitations]").change(function(){var b=a("#Limitations:checked").val();b=="1"?a(".communicate-method").show():a(".communicate-method").hide()}),a("input[name=AccessOfRights]").change(function(){var b=a("#AccessOfRights:checked").val();b=="1"?a(".communicate-rights").show():a(".communicate-rights").hide()}),a(".child-part8").click(function(){Friendly.SubmitForm("communication","schedule")}),a("input[name=DetermineBeginDate]").change(function(){var b=a("#DetermineBeginDate:checked").val();b==="1"?a(".schedule-date").hide():a(".schedule-date").show()}),a("input[name=Weekdays]").change(function(){var b=a("#Weekdays:checked").val();b==="1"?a(".schedule-weekday").show():a(".schedule-weekday").hide()}),a("input[name=FatherWeekend]").change(function(){var b=a("#FatherWeekend:checked").val();a(".schedule-weekend-other").hide();switch(b){case"1":a('#MotherWeekend[value="1"]').attr("checked","checked");break;case"2":a('#MotherWeekend[value="4"]').attr("checked","checked");break;case"3":a('#MotherWeekend[value="4"]').attr("checked","checked");break;case"4":a('#MotherWeekend[value="3"]').attr("checked","checked");break;case"5":a('#MotherWeekend[value="5"]').attr("checked","checked"),a(".schedule-weekend-other").show()}}),a("input[name=MotherWeekend]").change(function(){var b=a("#MotherWeekend:checked").val();a(".schedule-weekend-other").hide();switch(b){case"1":a('#FatherWeekend[value="1"]').attr("checked","checked");break;case"2":a('#FatherWeekend[value="4"]').attr("checked","checked");break;case"3":a('#FatherWeekend[value="4"]').attr("checked","checked");break;case"4":a('#FatherWeekend[value="3"]').attr("checked","checked");break;case"5":a('#FatherWeekend[value="5"]').attr("checked","checked"),a(".schedule-weekend-other").show()}}),a(".child-part9").click(function(){var b=Friendly.GetFormInput("schedule"),c="schedule",d="holiday",e="#"+c;if(a(e).valid())a.ajax({url:"/api/"+c+"?format=json",type:"POST",data:b,success:function(){return Parenting.LoadChildren("holiday"),Friendly.NextForm(d,Friendly.properties.iconSuccess),Friendly.EndLoading(),!1},error:Friendly.GenericErrorMessage});else return Friendly.EndLoading(),!1;return!1}),a("#addHolidays").click(function(){Friendly.StartLoading();var b="extraHoliday",c={ChildId:a("#holidayChildId").val(),HolidayFather:a("#ExtraHolidayViewModel_HolidayFather:checked").val(),HolidayMother:a("#ExtraHolidayViewModel_HolidayMother:checked").val(),HolidayName:a("#ExtraHolidayViewModel_HolidayName").val(),UserId:a("#user-id").val()};if(a("#"+b).valid())a.ajax({url:"/api/"+b+"?format=json",type:"POST",data:c,success:function(b){var c=a("#friendly-extraHolidays-template").tmpl(b.ExtraHoliday);return a("#holiday").append(c),a("input[id=ExtraHolidayViewModel_HolidayFather]").removeAttr("checked"),a("input[id=ExtraHolidayViewModel_HolidayMother]").removeAttr("checked"),a("#ExtraHolidayViewModel_HolidayName").val(""),Friendly.EndLoading(),!1},error:Friendly.GenericErrorMessage});else return Friendly.EndLoading(),!1;return!1}),a(".father-all input[type=radio]").change(function(){var b=a(this).attr("name"),d=a('input[name="'+b+'"]:checked').val();a.each(a(".holiday-parent input[value="+d+"]"),function(b,e){var f=a(e).attr("name");if(typeof f=="undefined")return;f.lastIndexOf("Father")>=0&&f.lastIndexOf("Father")>f.lastIndexOf("Mother")?a(this).attr("checked","checked"):(f=f.replace(".","_"),c(f,d))})}),a(".mother-all input[type=radio]").change(function(){var b=a(this).attr("name"),d=a('input[name="'+b+'"]:checked').val();a.each(a(".holiday-parent input[value="+d+"]"),function(b,e){var f=a(e).attr("name");if(typeof f=="undefined")return;f.lastIndexOf("Mother")>=0&&f.lastIndexOf("Mother")>f.lastIndexOf("Father")?a(this).attr("checked","checked"):(f=f.replace(".","_"),c(f,d))})}),a(".holiday-parent input[type=radio]").live("change",function(){var b=a(this).attr("name"),d=a('input[name="'+b+'"]:checked').val(),e="",f="";return b.lastIndexOf("Father")>=0&&b.lastIndexOf("Father")>b.lastIndexOf("Mother")?(b.length>b.lastIndexOf("Father")+6&&(f=b.substring(b.lastIndexOf("Father")+6,b.length)),e=b.substring(0,b.lastIndexOf("Father"))+"Mother"+f,e=e.replace(".","_")):b.lastIndexOf("Mother")>=0&&b.lastIndexOf("Mother")>b.lastIndexOf("Father")&&(e=b.substring(0,b.lastIndexOf("Mother"))+"Father",e=e.replace(".","_")),c(e,d),!1}),a(".child-part10").click(function(){Parenting.AddHoliday(this)}),a("input[name=HasAddendum]").change(function(){var b=a("#HasAddendum:checked").val();b=="1"?a(".addendum-details").show():a(".addendum-details").hide()}),a(".child-part11").click(function(){var b="addendum";if(a("#"+b).valid()){Friendly.StartLoading();var c=Friendly.GetFormInput(b);a.ajax({url:"/api/"+b+"?format=json",type:"POST",data:c,success:function(){var a=["privacy","information","decisions","responsibility","communication","schedule","holiday","addendum"],b=["Supervision","Information","Decisions","Responsibility","Communication","Schedule","Holiday","Addendum"];Friendly.ValidateForms(a,b,".child-part11"),Friendly.EndLoading()},error:Friendly.GenericErrorMessage})}return!1}),a('input[name="HolidayViewModel.Thanksgiving"]').change(function(){var b=a("#HolidayViewModel_Thanksgiving:checked").val();b==="3"?a(".thanksgiving-other").show():a(".thanksgiving-other").hide()}),a('input[name="HolidayViewModel.SpringBreak"]').change(function(){var b=a("#HolidayViewModel_SpringBreak:checked").val();b==="2"?a(".spring-other").show():a(".spring-other").hide()}),a('input[name="HolidayViewModel.FallBreak"]').change(function(){var b=a("#HolidayViewModel_FallBreak:checked").val();b==="2"?a(".fall-other").show():a(".fall-other").hide()}),a('input[name="HolidayViewModel.Christmas"]').change(function(){var b=a("#HolidayViewModel_Christmas:checked").val();a(".christmas-items").hide(),a(".christmas-other").hide();switch(b){case"2":a(".christmas-items").show();break;case"3":a(".christmas-items").show();break;case"4":a(".christmas-items").show();break;case"5":a(".christmas-other").show()}}),a("#copy-holidays").on("click","li a",function(){if(!a("#holiday").valid())return;Friendly.StartLoading();var b=a(this).attr("data-id");if(b==="0")for(var c=0;c<Friendly.children.length;c++){var e=Friendly.children[c];c==Friendly.children.length-1?d(e.Id,!0):d(e.Id,!1)}else{var f=a("#holidayChildId").val().trim();d(f,!1),d(b,!0)}Friendly.EndLoading()})})